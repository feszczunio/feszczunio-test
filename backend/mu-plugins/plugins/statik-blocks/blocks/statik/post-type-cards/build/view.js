var StatikPostTypeCardsBlock;!function(){"use strict";var t={n:function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,{a:r}),r},d:function(e,r){for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return p}});var r=window.wp.apiFetch,s=t.n(r);class a{static render(t){const e=document.createElement("template");return e.innerHTML=this.renderCard(t),e.content}static renderCard(t){return"area"===t.followUpArea?[`<a class="wp-block-statik-post-type-cards__card" href="${t.link}">`,this.renderContentHtml(t),"</a>"].join(""):"none"===t.followUpArea||"button"===t.followUpArea?['<div class="wp-block-statik-post-type-cards__card">',this.renderContentHtml(t),"</div>"].join(""):void 0}static renderContentHtml(t){return[this.renderImageHtml(t),this.renderCategoriesHtml(t),this.renderDateHtml(t),this.renderTitleHtml(t),this.renderExcerptHtml(t),this.renderTagsHtml(t),this.renderReadMoreButtonHtml(t)].join("")}static renderImageHtml(t){if(t.displayFeaturedImage)return t.hasFeaturedImage?['<div class="wp-block-statik-post-type-cards__image">',`<img srcset="${t.imageSrcsetAttr}" src="${t.imageSrcAttr}" alt="${t.imageAltAttr}" />`,"</div>"].join(""):'<div class="wp-block-statik-post-type-cards__image--empty"></div>'}static renderCategoriesHtml(t){if(t.displayCategories)return['<ul class="wp-block-statik-post-type-cards__categories">',t.categories.map((t=>`<li>${t.name}</li>`)).join(""),"</ul>"].join("")}static renderDateHtml(t){if(t.displayDate)return[`<time class="wp-block-statik-post-type-cards__updated" datetime="${t.dateTime}">`,t.dateTime,"</time>"].join("")}static renderTitleHtml(t){if(t.displayTitle)return`<h3>${t.title}</h3>`}static renderExcerptHtml(t){if(t.displayExcerpt)return['<div class="wp-block-statik-post-type-cards__excerpt">',t.excerpt,"</div>"].join("")}static renderTagsHtml(t){if(t.displayTags)return['<ul class="wp-block-statik-post-type-cards__tags">',t.tags.map((t=>`<li>${t.name}</li>`)).join(""),"</ul>"].join("")}static renderReadMoreButtonHtml(t){if(t.displayReadMoreButton){if("none"===t.followUpArea||"area"===t.followUpArea)return['<div class="wp-block-statik-post-type-cards__read-more" >',"Read More","</div>"].join("");if("button"===t.followUpArea)return[`<a class="wp-block-statik-post-type-cards__read-more" href="${t.link}">`,"Read More","</a>"].join("");throw new Error(`Unsupported 'followUpArea' value: ${t.followUpArea}`)}}}var i=window.statik.utils;class n{static render(t){const e=document.createElement("template");return e.innerHTML=this.renderStyle(t),e.content.firstElementChild}static renderStyle(t){const e=(0,i.rwdAttribute)(t.cardsPerRow);return`\n\t\t<style>\n\t\t.wp-block-${t.blockId} {\n\t\t  --wp-block-statik-post-type-cards--attr--cardsPerRow: ${e.inherit.mobile};\n\t\t}\n\t\t@media (min-width: 991px) {\n\t\t  .wp-block-${t.blockId} {\n\t\t\t--wp-block-statik-post-type-cards--attr--cardsPerRow: ${e.inherit.tablet};\n\t\t  }\n\t\t}\n\t\t@media (min-width: 1200px) {\n\t\t  .wp-block-${t.blockId} {\n\t\t\t--wp-block-statik-post-type-cards--attr--cardsPerRow: ${e.inherit.desktop};\n\t\t  }\n\t\t}\n\t\t</style>\n\t  `}}class o{constructor(t){this.rootElement=document.querySelector(t)}empty(){this.rootElement.innerHTML=""}render(t,e){const r=t.map((t=>a.render(t)));this.rootElement.append(...r);const s=n.render(e);this.rootElement.before(s)}renderError(t){const e=document.createElement("template");e.innerHTML=['<div class="wp-block-statik-post-type-cards__error">',t,"</div>"].join(""),this.rootElement.append(e.content)}}class d{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model=t,this.view=e,this.attributes=r.attributes,this.restBase=r.restBase,this.currentPostId=r.currentPostId}async init(){let t;try{t=await this.fetchPosts()}catch(t){return console.error("There was a problem with the fetch operation:",t),this.view.empty(),void this.view.renderError("Sorry, something went wrong. Please try again later.")}this.handleAddPosts(t),this.view.empty(),this.view.render(this.model.posts,this.attributes)}async fetchPosts(){const t=this.attributes.query,e=t.exclude?[].concat(t.exclude):[];this.attributes.excludeCurrentPost&&e.push(this.currentPostId);const r={...t,exclude:e.length?e:""},a=new URLSearchParams(r).toString();return await s()({path:`/wp/v2/${this.restBase}?_embed&${a}`})}handleAddPosts(t){t.forEach((t=>{this.model.addPost(t,this.attributes)}))}}class l{constructor(t,e){this.post=t,this.attributes=e}get followUpArea(){return this.attributes.followUpArea}get displayFeaturedImage(){return this.attributes.displayFeaturedImage}get link(){return this._getUrlHref()}get hasFeaturedImage(){const t=this.post._embedded?.["wp:featuredmedia"];return Array.isArray(t)&&t.length>0}get featuredImage(){if(!this.hasFeaturedImage)return;const t=this.post._embedded?.["wp:featuredmedia"];return t[0]}get imageSrcsetAttr(){return this._getSrcsetAttribute(this.featuredImage.media_details.sizes)}get imageSrcAttr(){return this.featuredImage.source_url}get imageAltAttr(){return this.featuredImage.title.rendered}get displayCategories(){return this.attributes.displayCategories}get categories(){return this._getTaxonomyTerms("categories")}get displayDate(){return this.attributes.displayLastUpdatedDate}get dateTime(){return this._getDayYYYYMMDD(this.post.modified_gmt)}get displayTitle(){return this.attributes.displayTitle}get title(){return this.post.title.rendered}get displayExcerpt(){return this.attributes.displayExcerpt}get excerpt(){return this.post.excerpt?.rendered}get displayTags(){return this.attributes.displayCategories}get tags(){return this._getTaxonomyTerms("tags")}get displayReadMoreButton(){return this.attributes.displayReadMoreButton}_getDayYYYYMMDD(t){const e=new Date(t);return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]}_getSrcsetAttribute(t){const e=[],r=Object.entries(t);for(const[,t]of r)e.push(`${t.source_url} ${t.width}w`);return e.join(", ")}_getTaxonomyTerms(t){var e,r;const s=null!==(e=this.post[t])&&void 0!==e?e:[];return(null!==(r=this.post._embedded?.["wp:term"]?.flat())&&void 0!==r?r:[]).filter((t=>s.includes(t.id)))}_getUrlHref(){const{destination:t}=this.attributes;if("default"===t)return this.post.link;const e=t;return this._getObjectPropertyByPath(this.post,e)}_getObjectPropertyByPath(t,e){const r=e.split(".").map((t=>this._convertCamelToSnake(t)));let s=t;for(const t of r){if(!s.hasOwnProperty(t)){s=void 0,console.error(`The provided path '${e}' cannot be resolved`);break}s=s[t]}return s}_convertCamelToSnake(t){return t.replace(/[A-Z]/g,((t,e)=>(0===e?"":"_")+t.toLowerCase()))}}class c{posts=[];addPost(t,e){this.posts.push(new l(t,e))}}function p(t){let{attributes:e,restBase:r,currentPostId:s}=t;document.addEventListener("DOMContentLoaded",(async()=>{const t=new d(new c,new o(`.wp-block-${e.blockId}`),{attributes:e,restBase:r,currentPostId:s});await t.init()}))}StatikPostTypeCardsBlock=e.default}();