"use strict";!function(d){!1!==window.hasOwnProperty("statikMenu")&&(window.statikMenu=window.statikMenu||{},window.statikMenu.instance={debug:parseInt(window.statikMenu.config.debug),nonce:window.statikMenu.config.nonce,$modal:d(document).find("#statik-menu-modal"),$fieldsetMegamenu:d(document).find(".field-megamenu-page"),initializeMegamenu:function(){var n=this;this.$fieldsetMegamenu.each(function(e,n){var n=d(n),t=n.find(".megamenu-edit-link"),i=n.find(".megamenu-remove-link");n.on("change",'select[id^="megamenu-page"]',function(e){var e=d(e.currentTarget).find(":selected"),n=e.data("edit-link"),e=e.data("remove-link");t.attr("disabled",0===n.length).attr("href",n),i.attr("disabled",0===e.length).attr("href",e)})}),this.$fieldsetMegamenu.on("click","a[disabled]",function(e){e.preventDefault(),e.stopPropagation()}),this.$fieldsetMegamenu.on("click",".megamenu-new-link, .megamenu-edit-link",function(e){e.preventDefault();e=d(e.currentTarget).attr("href");0!==e.length&&n.showModal(e)})},initializeModal:function(){var e=this;this.$modal.on("click",".close",function(){e.reloadCurrentEditingMenu(),e.$modal.removeClass("show").fadeOut(),e.$modal.find("iframe").attr("src",""),d("body").css("overflow","")})},showModal:function(e){this.$modal.find("iframe").attr("src",e+"&statik=menu-modal"),this.$modal.addClass("show"),d("body").css("overflow","hidden")},reloadCurrentEditingMenu:function(){var t=this;d(".field-megamenu-page select").attr("disabled","disabled"),d.ajax({url:ajaxurl,method:"post",data:{action:"statik_menu",navId:d(document).find("#nav-menu-meta-object-id").val(),nonce:this.nonce},success:function(e){var n=e.success,a=e.data;!1!==n&&(t.$fieldsetMegamenu=d(document).find(".field-megamenu-page"),t.$fieldsetMegamenu.each(function(e,n){var t=d(n).find("select"),i=t.val();t.replaceWith(a.replaceAll("{{TEMPLATE_MENU_ID}}",d(n).data("menu-item"))),d(n).find("select").val(i)}))},error:function(e){return t.debug&&console.error(e)}})},initializeMegamenuEdit:function(){-1!==window.location.search.indexOf("statik=menu-modal")&&window.hasOwnProperty("wp")&&window.hasOwnProperty("_wpLoadBlockEditor")&&(d(document).find("body").addClass("statik-menu-modal"),window._wpLoadBlockEditor.then(function(){wp.data.subscribe(function(){!1===wp.data.select("core/edit-post").isFeatureActive("fullscreenMode")&&wp.data.dispatch("core/edit-post").toggleFeature("fullscreenMode")})}))}},window.statikMenu.instance.initializeMegamenu(),window.statikMenu.instance.initializeModal(),window.statikMenu.instance.initializeMegamenuEdit())}(window.jQuery);