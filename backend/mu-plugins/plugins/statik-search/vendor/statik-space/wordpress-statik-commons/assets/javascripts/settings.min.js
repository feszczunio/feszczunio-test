"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(u){!1!==window.hasOwnProperty("statikCommon")&&(window.statikCommon=window.statikCommon||{},window.statikCommon.instance={debug:parseInt(window.statikCommon.config.debug),nonce:window.statikCommon.config.nonce,assetsUrl:window.statikCommon.config.assetsUrl,$wrapper:u(document).find("#statik"),$multipleSelects:u(document).find("#statik select[data-multiple]"),$passwordInputs:u(document).find("#statik div:has(> input.statik-is-password)"),$repeaters:u(document).find("#statik .js-repeater-wrapper"),$confirm:u(document).find("#statik .js-confirm-wrapper"),handleAsyncSelectsFields:function(){var i=this;this.$wrapper.find("select[data-async]").each(function(e,t){var n=u(t),r=n.data("current-value"),a=n.parent();u.ajax({url:n.data("async"),method:"GET",beforeSend:function(e){a.addClass("loading"),e.setRequestHeader("X-WP-Nonce",i.nonce)},error:function(e){return i.debug&&console.log(e)},success:function(e){"object"===_typeof(e)&&e.forEach(function(e){e.value===r&&(e.selected=!0),n.append(u("<option>",e))}),n.attr("data-disabled")||n.removeAttr("disabled")},complete:function(){return a.removeClass("loading")}})})},handleMultipleSelects:function(){var e=this;0!==this.$multipleSelects.length&&(u("<link/>",{rel:"stylesheet",type:"text/css",href:this.assetsUrl+"/stylesheets/vendors/selectize-0.15.2.min.css"}).appendTo("head"),u.getScript("".concat(this.assetsUrl,"/javascripts/vendors/jquery-ui-1.13.2.min.js"),function(){u.getScript("".concat(e.assetsUrl,"/javascripts/vendors/selectize-0.15.2.min.js"),function(){e.$multipleSelects.each(function(e,t){var n=u(t).data("validation"),r=1===u(t).data("create");u(t).selectize({plugins:["remove_button","drag_drop"],delimiter:",",persist:!1,mode:"multi",create:r&&function(e){return!("string"==typeof n&&!RegExp(n).test(e))&&{value:e,text:e}}})})})}))},handlePasswordField:function(){0!==this.$passwordInputs.length&&this.$passwordInputs.on("click",function(e){u(e.target).siblings("input").val("").removeAttr("disabled").removeAttr("placeholder").focus()})},handleRepeaters:function(){0!==this.$repeaters.length&&(this.$repeaters.on("click",".js-add-row",function(e){e.preventDefault();var e=u(e.currentTarget).closest(".js-repeater-wrapper"),t=e.find(".js-fields-wrapper .js-repeater-row:last-of-type").data("key")||0;e.find(".js-fields-wrapper").append(e.find(".js-template").html().replace(/data-template-name/g,"name").replace(/data-template-required/g,"required").replace(/template-key/g,t+1))}),this.$repeaters.on("click",".js-remove-row",function(e){e.preventDefault(),u(e.currentTarget).closest(".js-repeater-row").remove()}))},handleSettingsSelect:function(){this.$wrapper.on("change","#nav-select",function(e){window.location.href=e.currentTarget.value})},handleConditionsFieldset:function(){function e(){var e=d.$wrapper.find(".statik-grid-row[data-conditions]"),l=d.$wrapper.find(".statik-generator[data-namespace]").data("namespace");e.each(function(e,t){for(var t=u(t),n=Object.entries(t.data("conditions")),r=[],a=0,i=n;a<i.length;a++){var o=_slicedToArray(i[a],2),s=o[0],o=o[1],c=void 0,c="!"===s.substring(s.length-1)&&(s=s.substring(0,s.length-1),!0),s=d.$wrapper.find('[name="'.concat(l,"[").concat(s,']"]'));s.length&&(s.is(":checkbox")?r.push(c?s.is(":checked")!==!!o:s.is(":checked")===!!o):r.push(c?s.val()!==o:s.val()===o))}r.filter(function(e){return e}).length===n.length?(t.css("display","grid"),t.find("input, select, textarea").each(function(e,t){t=u(t);t.attr("required",t.attr("data-required")).removeAttr("data-required").attr("name",t.attr("data-name")).removeAttr("data-name")})):(t.css("display","none"),t.find("input, select, textarea").each(function(e,t){t=u(t);t.attr("data-required",t.attr("required")).removeAttr("required").attr("data-name",t.attr("name")).removeAttr("name")}))})}var d=this;this.$wrapper.on("change","form",e),e()},handleConfirm:function(){0!==this.$confirm.length&&(u("<link/>",{rel:"stylesheet",type:"text/css",href:"".concat(this.assetsUrl,"/stylesheets/vendors/jquery-confirm-3.3.4.min.css")}).appendTo("head"),u.getScript("".concat(this.assetsUrl,"/javascripts/vendors/jquery-confirm-3.3.4.min.js")))}},window.statikCommon.instance.handleAsyncSelectsFields(),window.statikCommon.instance.handleMultipleSelects(),window.statikCommon.instance.handlePasswordField(),window.statikCommon.instance.handleRepeaters(),window.statikCommon.instance.handleSettingsSelect(),window.statikCommon.instance.handleConditionsFieldset(),window.statikCommon.instance.handleConfirm())}(window.jQuery);